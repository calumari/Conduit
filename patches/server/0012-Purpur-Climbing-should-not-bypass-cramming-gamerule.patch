From 0331d666046cf265ce640d3aa8515418a6a4b460 Mon Sep 17 00:00:00 2001
From: Callum <38501234+calumari@users.noreply.github.com>
Date: Fri, 29 May 2020 12:41:41 +0100
Subject: [PATCH] Purpur Climbing should not bypass cramming gamerule

---
 src/main/java/net/minecraft/server/EntityLiving.java         | 2 +-
 .../socialhangover/conduit/config/ConduitWorldConfig.java    | 5 +++++
 2 files changed, 6 insertions(+), 1 deletion(-)

diff --git a/src/main/java/net/minecraft/server/EntityLiving.java b/src/main/java/net/minecraft/server/EntityLiving.java
index 3fc2360a1..96288224f 100644
--- a/src/main/java/net/minecraft/server/EntityLiving.java
+++ b/src/main/java/net/minecraft/server/EntityLiving.java
@@ -2812,7 +2812,7 @@ public abstract class EntityLiving extends Entity {
 
     @Override
     public boolean isCollidable() {
-        return this.isAlive() && !this.isClimbing() && this.collides; // CraftBukkit
+        return this.isAlive() && (world.conduitConfig.fixClimbingBypassingCrammingRule || !this.isClimbing()) && this.collides; // Conduit // CraftBukkit
     }
 
     @Override
diff --git a/src/main/java/net/socialhangover/conduit/config/ConduitWorldConfig.java b/src/main/java/net/socialhangover/conduit/config/ConduitWorldConfig.java
index 5303f4681..6a8fb505d 100644
--- a/src/main/java/net/socialhangover/conduit/config/ConduitWorldConfig.java
+++ b/src/main/java/net/socialhangover/conduit/config/ConduitWorldConfig.java
@@ -51,6 +51,11 @@ public class ConduitWorldConfig {
         return config.getString("world-settings." + worldName + "." + path, config.getString("world-settings.default." + path));
     }
 
+    public boolean fixClimbingBypassingCrammingRule;
+    private void gameplayMechanics() {
+        fixClimbingBypassingCrammingRule = getBoolean("gameplay-mechanics.fix-climbing-bypassing-cramming-rule", false);
+    }
+
     public boolean allowLeashVillager;
     private void villagerSettings() {
         allowLeashVillager = getBoolean("mobs.villager.allow-leash", false);
-- 
2.24.1.windows.2

